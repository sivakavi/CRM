var customerObj = [
    { 'id': '1', 'fname': 'sivakavi', 'lname': 'rew', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '1', 'member_id': '1', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '2', 'fname': 'dsf', 'lname': 'jayaeredevan', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '1', 'member_id': '1', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '3', 'fname': 'sadf', 'lname': 'geg', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '4', 'member_id': '3', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '4', 'fname': 'asdf', 'lname': 'grdeg', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '2', 'member_id': '5', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '5', 'fname': 'sivaasdfkavi', 'lname': 'jayadevan', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '2', 'member_id': '4', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '6', 'fname': 'sivakavi', 'lname': 'qqafe', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '3', 'member_id': '2', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '7', 'fname': 'asdf', 'lname': 'jdx', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '3', 'member_id': '3', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '8', 'fname': 'sivakavi', 'lname': 'dfgs', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '3', 'member_id': '1', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '9', 'fname': 'sivaksdfsavi', 'lname': 'sadfadf', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '2', 'member_id': '2', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '10', 'fname': 'ukhly', 'lname': 'bbbb', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '2', 'member_id': '4', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '11', 'fname': 'sivaksfdavi', 'lname': 'dfg', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '3', 'member_id': '3', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '12', 'fname': 'sivacasckavi', 'lname': 'jayadevan', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '1', 'member_id': '5', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '13', 'fname': 'fghft', 'lname': 'dfg', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '1', 'member_id': '4', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '14', 'fname': 'uireg', 'lname': 'jayadevan', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '1', 'member_id': '4', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '15', 'fname': 'ghrntrt', 'lname': 'sdfgs', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '2', 'member_id': '5', 'interest': 'xxxxxx', 'photo': '' },
    { 'id': '16', 'fname': 'fgd', 'lname': 'fgdfrg', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'occupation': 'Software Developer', 'lead_id': '4', 'member_id': '2', 'interest': 'xxxxxx', 'photo': '' }
];

var userObj = [
    { 'id': '1', 'fname': 'sivakavi', 'lname': 'jayadevan', 'phone': '2436587', 'mobile': '9629129377', 'email': 'sivakavi63@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'photo': '', 'role_id': '1', 'username': 'sivakavi', 'password': 'sivakavi', 'host': '', 'port': '', 'smtp_name': '', 'smtp_pass': '' },
    { 'id': '1', 'fname': 'janaki', 'lname': 'r', 'phone': '2436587', 'mobile': '9715261931', 'email': 'surendar@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '28/11/1989', 'gender': '2', 'photo': '', 'role_id': '2', 'username': 'surendar', 'password': 'surendar', 'host': '', 'port': '', 'smtp_name': '', 'smtp_pass': '' },
    { 'id': '1', 'fname': 'santhosh', 'lname': 'k', 'phone': '2436587', 'mobile': '9894252587', 'email': 'santhosh@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '04/06/1992', 'gender': '1', 'photo': 'img/profile.jpg', 'role_id': '3', 'username': 'santhosh', 'password': 'santhosh', 'host': '', 'port': '', 'smtp_name': '', 'smtp_pass': '' },
    { 'id': '1', 'fname': 'srini', 'lname': 'r', 'phone': '2436587', 'mobile': '8973738954', 'email': 'srini@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '25/05/1988', 'gender': '1', 'photo': '', 'role_id': '4', 'username': 'srini', 'password': 'srini', 'host': '', 'port': '', 'smtp_name': '', 'smtp_pass': '' },
    { 'id': '1', 'fname': 'kavi', 'lname': 'jayadevan', 'phone': '2436587', 'mobile': '9843926580', 'email': 'kavi@gmail.com', 'address1': '44 Main Road', 'address2': 'Kalmandapam', 'city': 'Puducherry', 'state': 'Puducherry', 'country': 'India', 'pincode': '605106', 'dob': '21/02/1990', 'gender': '1', 'photo': '', 'role_id': '5', 'username': 'kavi', 'password': 'kavi', 'host': '', 'port': '', 'smtp_name': '', 'smtp_pass': '' }
];

var leadSource = [
    { 'lead_id': '1', 'lead_name': 'Web' },
    { 'lead_id': '2', 'lead_name': 'Google' },
    { 'lead_id': '3', 'lead_name': 'Facebook' },
    { 'lead_id': '4', 'lead_name': 'Twitter' }
];

var userRole = [
    { 'role_id': '1', 'role_type': 'Admin' },
    { 'role_id': '2', 'role_type': 'Sales' },
    { 'role_id': '3', 'role_type': 'Marketing' },
    { 'role_id': '4', 'role_type': 'Support' },
    { 'role_id': '5', 'role_type': 'Telecaller' }
];

var memberType = [
    { 'member_id': '1', 'member_type': 'Bronze' },
    { 'member_id': '2', 'member_type': 'Silver' },
    { 'member_id': '3', 'member_type': 'Gold' },
    { 'member_id': '4', 'member_type': 'Diamond' },
    { 'member_id': '5', 'member_type': 'Platinum' }
];

var appoinmentStatus = [
    { 'status_id': '1', 'status_name': 'Confirmed' },
    { 'status_id': '2', 'status_name': 'Pending' },
    { 'status_id': '3', 'status_name': 'Inprogress' },
    { 'status_id': '4', 'status_name': 'Cancelled' }
];

var productCategory = [
    { 'product_id': '1', 'product_name': 'System accessories' },
    { 'product_id': '2', 'product_name': 'Furniture' },
    { 'product_id': '3', 'product_name': 'Electronics' },
    { 'product_id': '4', 'product_name': 'Tiles' },
    { 'product_id': '5', 'product_name': 'Mechanical tools'}
];


CRM.controller('LoginCtrl', function ($rootScope, $scope, $state) {
    //console.log("login controller working.....");
    $scope.user = userObj;
    $scope.userd = {
        "username": "",
        "password": ""
    };
    $rootScope.currentUser = "";

    $scope.login = function (logincredentials) {

        var flag = false;

        for (var i = 0; i < $scope.user.length; i++) {
            if ($scope.user[i].username == logincredentials.username && $scope.user[i].password == logincredentials.password) {
                $rootScope.currentUser = $scope.user[i];
                flag = true;
                $state.go('app.dashboard');
                break;
            }
        }

        if (!flag) {
            $scope.userd.username = "";
            $scope.userd.password = "";
            Materialize.toast('Invalid Username and Password', 3000);
        }

    };

});
CRM.controller('GraphCtrl', function ($rootScope, $scope, $state) {});

CRM.controller('MainCtrl', function ($rootScope, $scope, $state) {
    $scope.isMobile = false;
    // media query event handler
if (matchMedia) {
  var mq = window.matchMedia("(max-width: 992px)");
  mq.addListener(WidthChange);
  WidthChange(mq);
}

// media query change
function WidthChange(mq) {

  if (mq.matches) {
    $scope.isMobile = true;
  } else {
    $scope.isMobile = false;
  }

}

// $(window).on('resize', function() {
//     var width = $(window).innerWidth();
//     console.log(width);
//     if (width > 992) {
//         $scope.isMobile = false;
//       } else if(width <= 992) {
//         $scope.isMobile = true;
//       }
//             });


});


CRM.controller('CustomerCtrl', function ($rootScope, $scope, $state) {

    $scope.customerlist = customerObj;
    
    $scope.singleCustomer = {
        'id': '',
        'fname': '',
        'lname': '',
        'phone': '',
        'mobile': '',
        'email': '',
        'address1': '',
        'address2': '',
        'city': '',
        'state': '',
        'country': '',
        'pincode': '',
        'dob': '',
        'gender': '',
        'occupation': '',
        'lead_id': '',
        'member_id': '',
        'interest': '',
        'photo': ''
    };

    $scope.clickCustomer = function () {
        $("#customerHead").empty();
        $("#customerHead").append("Add Customer");
        $("#viewsection").hide();
        $("#addeditsection").show();
        $scope.singleCustomer = {};
    };
    
    $scope.customerEdit = function (customer) {
        $("#customerHead").empty();
        $("#customerHead").append("Edit Customer");
        $("#viewsection").hide();
        $("#addeditsection").show();
        $scope.singleCustomer = customer;
        $('ul.tabs').tabs('select_tab', 'test2');
    };

    $scope.customerView = function (customer) {
        $("#customerHead").empty();
        $("#customerHead").append("View Customer");
        $("#addeditsection").hide();
        $("#viewsection").show();
        $scope.singleCustomer = customer;
        $('ul.tabs').tabs('select_tab', 'test2');
    };

});


CRM.controller('StaffCtrl', function ($rootScope, $scope, $state) {

    $scope.stafflist = userObj;

    $scope.singleStaff = {
        'id': '',
        'fname': '',
        'lname': '',
        'phone': '',
        'mobile': '',
        'email': '',
        'address1': '',
        'address2': '',
        'city': '',
        'state': '',
        'country': '',
        'pincode': '',
        'dob': '',
        'gender': '',
        'photo': '',
        'role_id': '',
        'username': '',
        'password': '',
        'host': '',
        'port': '',
        'smtp_name': '',
        'smtp_pass': ''
    };

    $scope.clickStaff = function () {
        $("#staffHead").empty();
        $("#staffHead").append("Add Staff");
        $("#viewsection").hide();
        $("#addeditsection").show();
        $scope.showconfirmpassword = true;
        $scope.singleStaff= {};
    };

    $scope.staffEdit = function (staff) {
        $("#staffHead").empty();
        $("#staffHead").append("Edit Staff");
        $("#viewsection").hide();
        $("#addeditsection").show();
        $scope.showconfirmpassword = false;
        $scope.singleStaff = staff;
        $('ul.tabs').tabs('select_tab', 'test2');
    };

    $scope.staffView = function (staff) {
        $("#staffHead").empty();
        $("#staffHead").append("View Staff");
        $("#addeditsection").hide();
        $("#viewsection").show();
        $scope.showconfirmpassword = true;
        $scope.singleStaff = staff;
        $('ul.tabs').tabs('select_tab', 'test2');
    };

});


CRM.controller('ManageCtrl', function ($rootScope, $scope, $state) {
    $scope.userRoleList = userRole;
    $scope.leadSourceList = leadSource;
    $scope.memberTypeList = memberType;
    $scope.appoinmentStatusList = appoinmentStatus;
    $scope.productCategoryList = productCategory;
});

CRM.controller('UiCalendarCtrl',
    function ($scope, $compile, $timeout, uiCalendarConfig) {
        var date = new Date();
        var d = date.getDate();
        var m = date.getMonth();
        var y = date.getFullYear();


        $scope.switchtotable = function () {
            $("#calandermode").hide();
            $("#tablemode").show();
        };

        $scope.switchtocalander = function () {
            $("#tablemode").hide();
            $("#calandermode").show();
        };


        $scope.changeTo = 'Hungarian';
        /* event source that pulls from google.com */
        $scope.eventSource = {
            url: "http://www.google.com/calendar/feeds/usa__en%40holiday.calendar.google.com/public/basic",
            className: 'gcal-event',           // an option!
            currentTimezone: 'America/Chicago' // an option!
        };
        /* event source that contains custom events on the scope */
        $scope.events = [
            { title: 'All Day Event', start: new Date(y, m, 1) },
            { title: 'Long Event', start: new Date(y, m, 22), end: new Date(y, m, 22) },
            { id: 999, title: 'Repeating Event', start: new Date(y, m, d - 3, 16, 0), allDay: false },
            { id: 999, title: 'Repeating Event', start: new Date(y, m, d + 4, 16, 0), allDay: false },
            { title: 'Birthday Party', start: new Date(y, m, d + 1, 19, 0), end: new Date(y, m, d + 1, 22, 30), allDay: false },
            { title: 'Click for Google', start: new Date(y, m, 28), end: new Date(y, m, 29), url: 'http://google.com/' }
        ];
        /* event source that calls a function on every view switch */
        $scope.eventsF = function (start, end, timezone, callback) {
            var s = new Date(start).getTime() / 1000;
            var e = new Date(end).getTime() / 1000;
            var m = new Date(start).getMonth();
            var events = [{ title: 'Feed Me ' + m, start: s + (50000), end: s + (100000), allDay: false, className: ['customFeed'] }];
            callback(events);
        };

        $scope.calEventsExt = {
            color: '#f00',
            textColor: 'yellow',
            events: [
                { type: 'party', title: 'Lunch', start: new Date(y, m, d, 12, 0), end: new Date(y, m, d, 14, 0), allDay: false },
                { type: 'party', title: 'Lunch 2', start: new Date(y, m, d, 12, 0), end: new Date(y, m, d, 14, 0), allDay: false },
                { type: 'party', title: 'Click for Google', start: new Date(y, m, 28), end: new Date(y, m, 29), url: 'http://google.com/' }
            ]
        };
        /* alert on eventClick */
        $scope.alertOnEventClick = function (date, jsEvent, view) {
            $scope.alertMessage = (date.title + ' was clicked ');
        };
        /* alert on Drop */
        $scope.alertOnDrop = function (event, delta, revertFunc, jsEvent, ui, view) {
            $scope.alertMessage = ('Event Dropped to make dayDelta ' + delta);
        };
        /* alert on Resize */
        $scope.alertOnResize = function (event, delta, revertFunc, jsEvent, ui, view) {
            $scope.alertMessage = ('Event Resized to make dayDelta ' + delta);
        };
        /* add and removes an event source of choice */
        $scope.addRemoveEventSource = function (sources, source) {
            var canAdd = 0;
            angular.forEach(sources, function (value, key) {
                if (sources[key] === source) {
                    sources.splice(key, 1);
                    canAdd = 1;
                }
            });
            if (canAdd === 0) {
                sources.push(source);
            }
        };
        /* add custom event*/
        $scope.addEvent = function () {
            $scope.events.push({
                title: 'Open Sesame',
                start: new Date(y, m, 28),
                end: new Date(y, m, 29),
                className: ['openSesame']
            });
        };
        /* remove event */
        $scope.remove = function (index) {
            $scope.events.splice(index, 1);
        };
        /* Change View */
        $scope.changeView = function (view, calendar) {
            uiCalendarConfig.calendars[calendar].fullCalendar('changeView', view);
        };
        /* Change View */
        $scope.renderCalender = function (calendar) {
            $timeout(function () {
                if (uiCalendarConfig.calendars[calendar]) {
                    uiCalendarConfig.calendars[calendar].fullCalendar('render');
                }
            });
        };
        /* Render Tooltip */
        $scope.eventRender = function (event, element, view) {
            element.attr({
                'tooltip': event.title,
                'tooltip-append-to-body': true
            });
            $compile(element)($scope);
        };
        /* config object */
        $scope.uiConfig = {
            calendar: {
                height: 450,
                editable: true,
                selectable: true,
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                select: function(start, end, allDay) {
                    uiCalendarConfig.calendars.availabilityCalendar.fullCalendar('refetchEvents');
                },

                eventClick: $scope.alertOnEventClick,
                eventDrop: $scope.alertOnDrop,
                eventResize: $scope.alertOnResize,
                eventRender: $scope.eventRender
            }
        };

        $scope.changeLang = function () {
            if ($scope.changeTo === 'Hungarian') {
                $scope.uiConfig.calendar.dayNames = ["Vasárnap", "Hétfő", "Kedd", "Szerda", "Csütörtök", "Péntek", "Szombat"];
                $scope.uiConfig.calendar.dayNamesShort = ["Vas", "Hét", "Kedd", "Sze", "Csüt", "Pén", "Szo"];
                $scope.changeTo = 'English';
            } else {
                $scope.uiConfig.calendar.dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                $scope.uiConfig.calendar.dayNamesShort = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
                $scope.changeTo = 'Hungarian';
            }
        };
        /* event sources array*/
        $scope.eventSources = [$scope.events, $scope.eventSource, $scope.eventsF];
        $scope.eventSources2 = [$scope.calEventsExt, $scope.eventsF, $scope.events];
    });

CRM.controller('ApplicationCtrl', function ($rootScope, $scope, $state) {
    console.log($rootScope.currentUser);
    $scope.userinfo = $rootScope.currentUser;
});

CRM.filter('leadSource', function () {
    return function (number) {
        for (var i = 0; i < leadSource.length; i++) {
            if (leadSource[i].lead_id == number) {
                return leadSource[i].lead_name;
            }
        }
    }
});

CRM.filter('userRole', function() {
    return function(number){
    
        for(var i=0;i<userRole.length;i++){
            if (userRole[i].role_id == number) {
                return userRole[i].role_type;
            }
        }
    }
});

CRM.filter('memberType', function () {
    return function (number) {

        for (var i = 0; i < memberType.length; i++) {
            if (memberType[i].member_id == number) {
                return memberType[i].member_type;
            }
        }
    }
});

CRM.filter('genderType', function () {

    var genderSource = [
    { 'id': '1', 'type': 'Male' },
    { 'id': '2', 'type': 'Female' },
    { 'id': '3', 'type': 'Other' }
    ];

    return function (number) {

        for (var i = 0; i < genderSource.length; i++) {
            if (genderSource[i].id == number) {
                return genderSource[i].type;
            }
        }
    }
});